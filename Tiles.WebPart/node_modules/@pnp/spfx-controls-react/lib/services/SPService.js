"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var ISPService_1 = require("./ISPService");
var sp_http_1 = require("@microsoft/sp-http");
var SPService = (function () {
    function SPService(_context) {
        this._context = _context;
    }
    /**
     * Get lists or libraries
     * @param options
     */
    SPService.prototype.getLibs = function (options) {
        var filtered;
        var queryUrl = this._context.pageContext.web.absoluteUrl + "/_api/web/lists?$select=Title,id,BaseTemplate";
        if (options.orderBy) {
            queryUrl += "&$orderby=" + (options.orderBy === ISPService_1.LibsOrderBy.Id ? 'Id' : 'Title');
        }
        if (options.baseTemplate) {
            queryUrl += "&$filter=BaseTemplate eq " + options.baseTemplate;
            filtered = true;
        }
        if (options.includeHidden === false) {
            queryUrl += filtered ? ' and Hidden eq false' : '&$filter=Hidden eq false';
            filtered = true;
        }
        return this._context.spHttpClient.get(queryUrl, sp_http_1.SPHttpClient.configurations.v1)
            .then(function (response) { return response.json(); });
    };
    return SPService;
}());
exports.default = SPService;

//# sourceMappingURL=SPService.js.map
